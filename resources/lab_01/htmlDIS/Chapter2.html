<!--This file created 18-10-1999 14:47 by Claris Home Page version 1.0--><HTML><HEAD>   <TITLE>Chapter 2 - Let's visualize a C program</TITLE>   <META NAME=GENERATOR CONTENT="Claris Home Page 1.0">   <X-SAS-WINDOW TOP=44 BOTTOM=760 LEFT=8 RIGHT=845>   <META NAME="Author" CONTENT="Irene Finocchi"></HEAD><BODY BGCOLOR="#FFFFFF" ALINK="#0000FF" VLINK="#551A8B"><P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><I><font color="#00007F" size="3">Chapter   2- Visualizing C programs</font></I></font><HR><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><I><BR></I>Software Visualization is the visualization of computer programs and algorithms, i.e. the use of images and animations to convey meaningful information about programs and their executions.<BR>Software Visualization finds its utility both in debugging, for discovering either programming errors or conceptual errors related to the algorithm design, and in education, for understanding and for teaching algorithms.</font><P><font size="2" face="Verdana, Arial, Helvetica, sans-serif">In this chapter   you will see two step-by-step examples showing how to use Leonardo to visualize   C programs. Chapters 9, 10, 11 and 12 will give you more detailed information   about these topics.</font></P><P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Leonardo's approach to visualization"></A><FONT COLOR="#990000">2.1   - Leonardo's approach to visualization</FONT></font></P><UL>  <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The   basic idea behind Leonardo's approach to visualization is to enrich a generic   C program with declarations that specify a graphical interpretation for program's   variables. This approach allows the user to get back his/her mental image of   program's data structures, making up for the loss of abstraction due to the   implementation process, and makes it simple to express and to check the formal   properties of algorithms.</font>   <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The     declarations are expressed in a logic programming language named Alpha and     are called </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><I><FONT COLOR="#000000">predicates</FONT></I><FONT COLOR="#000000">.     The syntax of Alpha and the computation mechanism of Alpha predicates are     described in Chapter 9.</FONT></font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Leonardo's     visualization system is able to recognize a set of </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><I><FONT COLOR="#000000">standard</FONT></I><FONT COLOR="#000000">     predicates, concerning the existence of graphical objects and their retinal     features, and to compute them in order to retrieve information about what     has to be visualized. The heads of standard predicates are predefined and     the user interested in realizing a new animation has only to fill-in their     bodies according to the program requirements.</FONT></font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In     other words, standard predicates are similar to the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">main</FONT></TT><FONT COLOR="#000000">     function of the C language, that is, a special function recognized and automatically     called by the environment. Due to their multiplicity, they are hierarchically     organized according to their logical dependencies: for instance, it does not     make sense for the user to define the color of an object which does not exist.     </FONT></font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Standard     predicates can be classified as: (a) animation control predicates (e.g., </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000"><A HREF="AppendixA1.html#Inference">InferenceOn</A></FONT></TT><FONT COLOR="#000000">),     (b) enumerative predicates defining objects and their structural properties     (e.g., </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA2.html#Line">Line</A></FONT></TT><FONT COLOR="#000000">     or </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA3.html#Graph">Graph</A></FONT></TT><FONT COLOR="#000000">),     and (c) predicates for attributes and retinal properties (e.g., </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA2.html#LineThickness">LineThickness</A></FONT></TT><FONT COLOR="#000000">     or </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA3.html#NodeColor">NodeColor</A></FONT></TT><FONT COLOR="#000000">).</FONT></font>   </P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In     order to use standard predicates, nothing special has to be done by Leonardo's     users, as standard predicates are automatically recognized by Leonardo's visualization     system.</font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">However,     in addition to standard predicates, Leonardo provides also </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><I><FONT COLOR="#000000">library</FONT></I><FONT COLOR="#000000">     predicates, that are built on the top of the standard ones and have more specialized     functions. For example, a library (named </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA4.html#ProgBarLib.c">ProgBarLib.c</A></FONT></TT><FONT COLOR="#000000">)     for visualizing the progress bar of running programs is available.</FONT></font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Libraries     have to be included in your C project in order to make related library predicates     work. For instance, if you want to use the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000"><A HREF="AppendixA4.html#ProgressBar">ProgressBar</A></FONT></TT><FONT COLOR="#000000">     library predicate, you should include </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA4.html#ProgBarLib.c">ProgBarLib.c</A></FONT></TT><FONT COLOR="#000000">     in your C project, or your declarations will have no effect. Libraries are     available in </FONT><TT><FONT COLOR="#000000">Leonardo Folder:C Libraries</FONT></TT><FONT COLOR="#000000">.</FONT></font></P>  <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Leonardo's     standard and library predicates are listed in <A HREF="AppendixA.html">Appendix     A</A>. A detailed description of each predicate, classified according to its     target, is given in </font><font size="2" face="Verdana, Arial, Helvetica, sans-serif"><A HREF="AppendixA1.html">Appendix     A1</A>, <A HREF="AppendixA2.html">Appendix A2</A>, <A HREF="AppendixA3.html">Appendix     A3</A>, <A HREF="AppendixA4.html">Appendix A4</A>, and <A HREF="AppendixA5.html">Appendix     A5</A>.</font></P>  <P>&nbsp;</P></UL><P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Visualization of the sorting algorithm"></A><FONT COLOR="#990000">2.2   - Visualization of the sorting algorithm</FONT></font></P><UL>  <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We   are now ready to visualize the bubblesort algorithm presented in <A HREF="Chapter1.html">Chapter   1</A>. We suppose that the syntax of this program has already been checked and   that the program has been successfully compiled. For the sake of clarity, we   show its code below:</font>   <P ALIGN=CENTER>  <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=10   WIDTH="90%">    <TR>       <TD nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">#include           </FONT><FONT COLOR="#000000">&lt;stdio.h&gt;</FONT></TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">n; </FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[100];</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">BubbleSort(</FONT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[],</FONT><FONT COLOR="#0000FF">int </FONT><FONT COLOR="#000000">n){</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i=-1,another; </FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">do             </FONT><FONT COLOR="#000000">{ </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=0;             </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for               </FONT><FONT COLOR="#000000">(i=1;i&lt;n;i++) </FONT></TT></font></P>            <UL>              <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">if               ((v[i-1]&gt;v[i])) { </FONT></TT> </font>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long                 </FONT><FONT COLOR="#000000">temp=v[i-1]; </FONT></TT> </font>                 <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i-1]=v[i];                   </FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i]=temp;</FONT></TT>                   </font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=1;</FONT></TT>                   </font></P>              </UL>              <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}                 </FONT></TT></font></P>            </UL>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}               </FONT><FONT COLOR="#0000FF">while </FONT><FONT COLOR="#000000">(another);               </FONT></TT></font></P>          </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>      <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">main(){ </FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i;</FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("How             many numbers ? "); </FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%d",&amp;n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) { </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("Enter             number #%d: ",i); </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%ld",&amp;v[i]);               </FONT></TT></font></P>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">BubbleSort(v,n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("v[%d]=%ld\n",i,v[i]);             </FONT></TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font face="Verdana, Arial, Helvetica, sans-serif" size="2">&nbsp; </font>   </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 1. Choosing the information to visualize"></A><B><FONT COLOR="#007F00">Step     1. Choosing the information to visualize</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The     basic step for building a visualization consists of deciding which information     has to be visualized and how it should appear. This is not always clear from     the beginning, and a definitive visualization can be usually created only     after successive and iterated refinement steps. However, you should have at     least a basic idea.</font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In       our example concerning bubblesort, we aim at creating the classical sticks       visualization for sorting algorithms: the numbers to be sorted are depicted       as an ordered set of sticks with heights proportional to their values. An       example of this kind of visualization is shown in the following image.</font></P>    <P ALIGN=CENTER><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><IMG      SRC="Images/Pic_2_1.GIF" WIDTH=303 HEIGHT=267      X-SAS-UseImageWidth X-SAS-UseImageHeight ALIGN=bottom></font> </P>  </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 2. Identifying the meaningful data structures"></A><B><FONT COLOR="#007F00">Step     2. Identifying the meaningful data structures</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Due     to Leonardo's approach to visualization, when designing a visualization it     should be clear which data structures in the source code contain the information     that we wish to visualize. Moreover, the scope of the meaningful data structures     should be identified: indeed, if an Alpha predicate uses a C variable, that     variable must be visible when the predicate is declared.</font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In       our example, the meaningful data structures are the following:</font></P>    <UL>      <LI><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">the         global variable </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">n</FONT></TT><FONT COLOR="#000000">,         containing the number of values to be sorted;</FONT></font>       <LI><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">the         global variable </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">,         that is the array containing the integer values to be sorted;</FONT></font>       <LI><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">the         variable </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">i</FONT></TT><FONT COLOR="#000000">,         local to the function </FONT><TT><FONT COLOR="#000000">BubbleSort</FONT></TT><FONT COLOR="#000000">         and used for scanning array </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">.<BR>        </FONT></font>     </UL>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We       will refer to variables </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">n</FONT></TT><FONT COLOR="#000000">       and </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">       for declaring the rectangles associated to the values to be sorted. On the       other side, variable </FONT><TT><FONT COLOR="#000000">i</FONT></TT><FONT COLOR="#000000">       will be used for coloring the rectangles corresponding to items being swapped       during the execution of the </FONT><TT><FONT COLOR="#000000">BubbleSort</FONT></TT><FONT COLOR="#000000">       function.</FONT></font></P>  </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 3. Creating a basic visualization"></A><B><FONT COLOR="#007F00">Step     3. Creating a basic visualization</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We     are now ready to implement a basic visualization. Namely, we declare a view     containing </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">n</FONT></TT><FONT COLOR="#000000">     rectangles identified by the numbers in the range </FONT><TT><FONT COLOR="#000000">0</FONT></TT><FONT COLOR="#000000">     to </FONT><TT><FONT COLOR="#000000">n-1</FONT></TT><FONT COLOR="#000000">.     The k-th rectangle has height proportional to the value </FONT><TT><FONT COLOR="#000000">v[k]</FONT></TT><FONT COLOR="#000000">.     </FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       following piece of code accomplishes this task. Paste this <A HREF="CodeSnippets/BasicBubbleVisual.c"      TARGET="_blank">piece of code</A> in Leonardo's text editor window as follows:       </font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=5   WIDTH="90%">    <TR>       <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">#include           </FONT><FONT COLOR="#000000">&lt;stdio.h&gt;</FONT></TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">n;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[100];</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           HSpace 8</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Width 12</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Middle 150</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Dy 4</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">View</FONT>(<FONT COLOR="#007F00">Out</FONT>           0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT>(<FONT COLOR="#007F00">Out</FONT>           N,<FONT COLOR="#007F00">Out</FONT> X,<FONT COLOR="#007F00">Out</FONT>           Y,<FONT COLOR="#007F00">Out</FONT> L,<FONT COLOR="#007F00">Out</FONT>           H,0)</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             N: <FONT COLOR="#007ECC">InRange</FONT>(N,0,n-1)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign             </FONT>L=Width</TT> </font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>H=v[N]*Dy</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>X=HSpace+(HSpace+Width)*N</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Y=Middle-H/2;</TT></font></P>          </BLOCKQUOTE>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">BubbleSort(</FONT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[],</FONT><FONT COLOR="#0000FF">int </FONT><FONT COLOR="#000000">n){</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i=-1,another; </FONT></TT> </font>         </UL>        <P>&nbsp;       </TD>      <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">do           </FONT><FONT COLOR="#000000">{ </FONT></TT> </font>           <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=0;             </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for               </FONT><FONT COLOR="#000000">(i=1;i&lt;n;i++) </FONT></TT></font></P>            <UL>              <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">if               ((v[i-1]&gt;v[i])) { </FONT></TT> </font>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long                 </FONT><FONT COLOR="#000000">temp=v[i-1]; </FONT></TT> </font>                 <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i-1]=v[i];                   </FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i]=temp;</FONT></TT>                   </font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=1;</FONT></TT>                   </font></P>              </UL>              <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}                 </FONT></TT></font></P>            </UL>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}             </FONT><FONT COLOR="#0000FF">while </FONT><FONT COLOR="#000000">(another);             </FONT></TT> </font></P>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}           </FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">main(){ </FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i;</FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("How             many numbers ? "); </FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%d",&amp;n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) { </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("Enter             number #%d: ",i); </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%ld",&amp;v[i]);               </FONT></TT></font></P>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort<FONT COLOR="#000000">(v,n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("v[%d]=%ld\n",i,v[i]);             </FONT></TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">First     of all, observe that the visualization predicates must be enclosed between     the symbols </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT><FONT COLOR="#000000">     and </FONT><TT><FONT COLOR="#000000">**/</FONT></TT><FONT COLOR="#000000">,     that denote special C comments containing information related to the visualization.     Hence, it should be noticed that in Leonardo the symbol </FONT><TT><FONT COLOR="#000000">/**</FONT></TT><FONT COLOR="#000000">     cannot be used for opening a generic C comment.</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       choice of enclosing visualization predicates in special comments guarantees       the reusability of your C source code, that can still be compiled in programming       environments other than Leonardo, even if it has been annotated with visualization       declarations. </font></P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">For       what concerns the visualization, note that four constants useful for defining       the geometric layout of rectangles are defined:</font></P>    <UL>      <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>HSpace         </TT><FONT COLOR="#000000">is the horizontal space inserted between consecutive         rectangles;</FONT></font>       <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Width         </TT><FONT COLOR="#000000">is the width of each rectangle;</FONT></font>       <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Middle         </TT><FONT COLOR="#000000">is used to center all the rectangles along         the y-axis;</FONT></font>       <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Dy </TT><FONT COLOR="#000000">is         used for scaling up the height of rectangles.</FONT></font>     </UL>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">All       constants indicate a number of pixels. Their meaning is illustrated in the       next figure:</font></P>    <P ALIGN=CENTER><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><IMG      SRC="Images/Pic_2_2.GIF" WIDTH=330 HEIGHT=306      X-SAS-UseImageWidth X-SAS-UseImageHeight ALIGN=bottom></font> </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Two       standard enumeration predicates have been used for realizing the visualization:       </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><A HREF="AppendixA2.html#View">View</A>       </TT><FONT COLOR="#000000">and </FONT><TT><A HREF="AppendixA2.html#Rectangle">Rectangle</A></TT><FONT COLOR="#000000">.</FONT></font>     </P>    <UL>      <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">View</FONT><FONT COLOR="#000000">(</FONT><FONT COLOR="#007F00">Out         </FONT><FONT COLOR="#000000">0)</FONT></TT><FONT COLOR="#000000"> implies         the opening of a window having identification number equal to 0.</FONT></font>       <LI><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT></TT><FONT COLOR="#000000">         declares the existence of a certain number of rectangles. Its first five         formal parameters (</FONT><TT><FONT COLOR="#000000">N</FONT></TT><FONT COLOR="#000000">,         </FONT><TT><FONT COLOR="#000000">X</FONT></TT><FONT COLOR="#000000">,         </FONT><TT><FONT COLOR="#000000">Y</FONT></TT><FONT COLOR="#000000">,         </FONT><TT><FONT COLOR="#000000">L</FONT></TT><FONT COLOR="#000000">,         and </FONT><TT><FONT COLOR="#000000">H</FONT></TT><FONT COLOR="#000000">)         represent the identification number, the x-coordinate and the y-coordinate         of the left-top corner, and the length and height of the rectangle, respectively.         The last formal parameter is the identification number of the window that         must contain the defined rectangles.</FONT></font>         <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">For           what concerns the implementation of </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT></TT><FONT COLOR="#000000">,           observe that the enumeration statement introduced by the keyword </FONT><TT><FONT COLOR="#007F00">For</FONT></TT><FONT COLOR="#000000">           is used for enumerating, one by one, all the numbers in the range </FONT><TT><FONT COLOR="#000000">[0..n-1]</FONT></TT><FONT COLOR="#000000">.           In particular, this is done by repeatedly calling a predefined predicate           named </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixA5.html#InRange">InRange</A></FONT></TT><FONT COLOR="#000000">.           </FONT></font></P>        <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Then,           after the identification number </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">N</FONT></TT><FONT COLOR="#000000">           of a rectangle has been obtained, its geometrical features are assigned.           Namely, its length </FONT><TT><FONT COLOR="#000000">L</FONT></TT><FONT COLOR="#000000">           is a predefined constant, and its height </FONT><TT><FONT COLOR="#000000">H</FONT></TT><FONT COLOR="#000000">           is proportional to the value in </FONT><TT><FONT COLOR="#000000">v </FONT></TT><FONT COLOR="#000000">corresponding           to the rectangle itself. The x-coordinate </FONT><TT><FONT COLOR="#000000">X</FONT></TT><FONT COLOR="#000000">           of the left-top corner is proportional to the identification number           of the rectangle, since rectangle </FONT><TT><FONT COLOR="#000000">N</FONT></TT><FONT COLOR="#000000">           must be assigned with the </FONT><TT><FONT COLOR="#000000">N</FONT></TT><FONT COLOR="#000000">-th           position. At last, the y-coordinate </FONT><TT><FONT COLOR="#000000">Y</FONT></TT><FONT COLOR="#000000">           of the left-top corner is assigned as follows: half of the height of           the rectangle is subtracted from the position of an imaginary horizontal           axis along which all the rectangles must be aligned (the subtraction           is due to the fact the the y-axis grows from top to bottom).</FONT></font></P>    </UL>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">At       this point, if you run the </font><font size="2" face="Verdana, Arial, Helvetica, sans-serif">program,       the execution environment should appear as follows:</font></P>    <P ALIGN=CENTER><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><IMG SRC="Images/Pic_2_3.GIF" WIDTH=640      HEIGHT=480 ALIGN=bottom></font></P>    <P><font size="2" face="Verdana, Arial, Helvetica, sans-serif">Note that a       view is automatically opened as a consequence of the declaration <TT><FONT COLOR="#007ECC">View</FONT>(<FONT COLOR="#007F00">Out</FONT>       0)</TT>. The name of the view contains the name of the project, i.e. <TT>BubbleSort</TT>,       followed by the keyword <TT>View</TT> and by the identification number,       i.e. <TT>0</TT>.</font></P>    <P><font size="2" face="Verdana, Arial, Helvetica, sans-serif">At the very       beginning of the execution, the view contains no rectangle since both the       value of variable <TT>n</TT> and the values in array <TT>v</TT> are equal       to <TT>0</TT>.</font></P>    <P><font size="2" face="Verdana, Arial, Helvetica, sans-serif">Now, you can       insert the input as requested by the program. We suggest to start with <TT>6</TT>       numbers (i.e. <TT>n=6</TT>) chosen as follows: <TT>50</TT>, <TT>30</TT>,       <TT>60</TT>, <TT>20</TT>, <TT>40</TT>, <TT>10</TT>. Note that, each time       a new value is assigned to array <TT>v</TT>, the corresponding rectangle       automatically appears in the view.</font></P>    <P><font size="2" face="Verdana, Arial, Helvetica, sans-serif">Finally, observe       that during the execution of the <TT>BubbleSort</TT> function, all the swaps       between items in <TT>v</TT> are automatically detected by Leonardo's visualization       system. Therefore, you will see the rectangles whose positions are being       exchanged that grow/shrink while they are being swapped. </font></P>  </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 4. Refining the visualization: adding colors to rectangles"></A><B><FONT COLOR="#007F00">Step     4. Refining the visualization: adding colors to rectangles</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In     order to produce a more communicative visualization, we can color the rectangles     so as to highlight the pair of rectangles that is considered for possible     swapping at each step of the execution of the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort</TT><FONT COLOR="#000000">     </FONT>function</font><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">.</font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We       can accomplish this task using the predicate </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000"><A HREF="AppendixA2.html#RectangleColor">RectangleColor</A></FONT></TT><FONT COLOR="#000000">.</FONT></font>     </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In       particular, in the global scope we declare that all rectangles are grey       using the following declaration:</font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLPADDING=10 WIDTH="70%">    <TR>       <TD>         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT><FONT COLOR="#007ECC">           </FONT><FONT COLOR="#007F00">Set </FONT>1: <FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>           <FONT COLOR="#BF3FBF">Grey</FONT>,0); **/</TT> </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><BR>    This means that any rectangle </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">N</FONT></TT><FONT COLOR="#000000">     contained in the view </FONT><TT><FONT COLOR="#000000">0</FONT></TT><FONT COLOR="#000000">     has a grey color. Note that </FONT><TT><FONT COLOR="#000000"><A HREF="AppendixB.html#Color">Grey</A></FONT></TT><FONT COLOR="#000000">     is a predefined constant: you can find a list of all such constants in </FONT></font><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><A HREF="AppendixB.html">Appendix     B</A>.</font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       directive </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Set</FONT></TT><FONT COLOR="#000000">       is used for grouping a set of predicates into a set and for assigning them       with a numeric label. In our example, the label </FONT><TT><FONT COLOR="#000000">1</FONT></TT><FONT COLOR="#000000">       is associated to the single declaration </FONT><TT><FONT COLOR="#007ECC">RectangleColor</FONT><FONT COLOR="#000000">(N,       </FONT><FONT COLOR="#007F00">Out</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#BF3FBF">Grey</FONT><FONT COLOR="#000000">,       0)</FONT></TT><FONT COLOR="#000000">. In this way, in the following we will       be able to refer to this declaration using its label for making it inactive       and possibly for substituting it with more appropriate visualization rules.</FONT></font></P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Indeed,       at the very beginning of the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort</TT><FONT COLOR="#000000">       function, we can write the following:</FONT></font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLPADDING=10 WIDTH="70%">    <TR>       <TD>         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Negate</FONT>           1;</TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>             C,0)</TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign</FONT>             C= (N==i) ? <FONT COLOR="#BF3FBF">Red</FONT> : (N==i-1) ? <FONT COLOR="#BF3FBF">Green</FONT>             : <FONT COLOR="#BF3FBF">Grey</FONT>;</TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><BR>    The directive </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Negate</FONT><FONT COLOR="#000000">     1</FONT></TT><FONT COLOR="#000000"> means that all visualization declarations     contained in set 1 are no more valid. In our example, only the declaration     </FONT><TT><FONT COLOR="#007ECC">RectangleColor</FONT><FONT COLOR="#000000">(N,     </FONT><FONT COLOR="#007F00">Out</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#BF3FBF">Grey</FONT><FONT COLOR="#000000">,     0)</FONT></TT><FONT COLOR="#000000"> belongs to set </FONT><TT><FONT COLOR="#000000">1</FONT></TT><FONT COLOR="#000000">;     hence, the assertion that all rectangles in view </FONT><TT><FONT COLOR="#000000">0</FONT></TT><FONT COLOR="#000000">     are grey is no longer valid.</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We       substitute it with another declaration, i.e. </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">RectangleColor</FONT><FONT COLOR="#000000">(N,       </FONT><FONT COLOR="#007F00">Out</FONT><FONT COLOR="#000000"> C, 0) </FONT><FONT COLOR="#007F00">Assign</FONT><FONT COLOR="#000000">       C= (N==i) ? </FONT><FONT COLOR="#BF3FBF">Red</FONT><FONT COLOR="#000000">       : (N==i-1) ? </FONT><FONT COLOR="#BF3FBF">Green</FONT><FONT COLOR="#000000">       : </FONT><FONT COLOR="#BF3FBF">Grey</FONT></TT><FONT COLOR="#000000">, that       means that the rectangle with identification number equal to </FONT><TT><FONT COLOR="#000000">i</FONT></TT><FONT COLOR="#000000">       is </FONT></font><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><A HREF="AppendixB.html#Color">Red</A>,       the rectangle with identification number equal to </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">i-1</FONT></TT><FONT COLOR="#000000">       is </FONT></font><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><A HREF="AppendixB.html#Color">Green</A>,       and all the remaining rectangles are <A HREF="AppendixB.html#Color">Grey</A>.</font>     </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       complete code obtained so far is shown below.</font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=5   WIDTH="90%">    <TR>       <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">#include           </FONT><FONT COLOR="#000000">&lt;stdio.h&gt;</FONT></TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">n;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[100];</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           HSpace 8</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Width 12</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Middle 150</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Dy 4</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">View</FONT>(<FONT COLOR="#007F00">Out</FONT>           0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT>(<FONT COLOR="#007F00">Out</FONT>           N,<FONT COLOR="#007F00">Out</FONT> X,<FONT COLOR="#007F00">Out</FONT>           Y,<FONT COLOR="#007F00">Out</FONT> L,<FONT COLOR="#007F00">Out</FONT>           H,0)</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             N: <FONT COLOR="#007ECC">InRange</FONT>(N,0,n-1)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign             </FONT>L=Width</TT> </font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>H=v[N]*Dy</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>X=HSpace+(HSpace+Width)*N</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Y=Middle-H/2;</TT></font></P>          </BLOCKQUOTE>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Set</FONT>           1: <FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>           <FONT COLOR="#BF3FBF">Grey</FONT>,0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">BubbleSort(</FONT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[],</FONT><FONT COLOR="#0000FF">int </FONT><FONT COLOR="#000000">n){</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i=-1,another; </FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>/**             </TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Negate</FONT>             1;</TT> </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>             C,0)</TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign</FONT>             C= (N==i) ? <FONT COLOR="#BF3FBF">Red</FONT> :</TT> </font>             <BLOCKQUOTE>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>(N==i-1)                 ? <FONT COLOR="#BF3FBF">Green</FONT> : <FONT COLOR="#BF3FBF">Grey</FONT>;</TT>                 </font>               </UL>            </BLOCKQUOTE>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT>             </font>        </UL>      </TD>      <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">do           </FONT><FONT COLOR="#000000">{ </FONT></TT> </font>           <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=0;             </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for               </FONT><FONT COLOR="#000000">(i=1;i&lt;n;i++) </FONT></TT></font></P>            <UL>              <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">if               ((v[i-1]&gt;v[i])) { </FONT></TT> </font>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long                 </FONT><FONT COLOR="#000000">temp=v[i-1]; </FONT></TT> </font>                 <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i-1]=v[i];                   </FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i]=temp;</FONT></TT>                   </font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=1;</FONT></TT>                   </font></P>              </UL>              <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}                 </FONT></TT></font></P>            </UL>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}             </FONT><FONT COLOR="#0000FF">while </FONT><FONT COLOR="#000000">(another);             </FONT></TT> </font></P>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">main(){ </FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i;</FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("How             many numbers ? "); </FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%d",&amp;n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) { </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("Enter             number #%d: ",i); </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%ld",&amp;v[i]);               </FONT></TT></font></P>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort<FONT COLOR="#000000">(v,n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("v[%d]=%ld\n",i,v[i]);             </FONT></TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Note     that at the end of the execution of the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort</TT><FONT COLOR="#000000">     function the assertions </FONT><TT><FONT COLOR="#007F00">Negate</FONT><FONT COLOR="#000000">     1 </FONT></TT><FONT COLOR="#000000">and </FONT><TT><FONT COLOR="#007ECC">RectangleColor</FONT><FONT COLOR="#000000">(N,     </FONT><FONT COLOR="#007F00">Out</FONT><FONT COLOR="#000000"> C, 0) </FONT><FONT COLOR="#007F00">Assign</FONT><FONT COLOR="#000000">     C= (N==i) ? </FONT><FONT COLOR="#BF3FBF">Red</FONT><FONT COLOR="#000000">     : (N==i-1) ? </FONT><FONT COLOR="#BF3FBF">Green</FONT><FONT COLOR="#000000">     : </FONT><FONT COLOR="#BF3FBF">Grey</FONT><FONT COLOR="#000000"> </FONT></TT><FONT COLOR="#000000">are     automatically 'undoed' because the scope containing them is over. As a cosequence,     the visualization rules contained in </FONT><TT><FONT COLOR="#007F00">Set</FONT></TT><FONT COLOR="#000000">     1 become active again and all rectangles are colored </FONT></font><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><A HREF="AppendixB.html#Color">Grey</A>     as before executing the function </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort</TT><FONT COLOR="#000000">.</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In       general, </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><B><FONT COLOR="#000000">the       visualization predicates have the same visibility rules as C variables</FONT></B><FONT COLOR="#000000">:       each predicate is active only within the scope where it has been declared.</FONT></font></P>  </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 5. Refining the visualization: skipping events"></A><B><FONT COLOR="#007F00">Step     5. Refining the visualization: skipping visualization events</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">If     you run the program, you can immediately observe that in the animation realized     so far there are some redundant visualization frames.</font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Indeed,       the swapping of two items in the </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort</TT><FONT COLOR="#000000">       function is performed by means of three consecutive assignment statements.       First, the value of item </FONT><TT><FONT COLOR="#000000">v[i-1]</FONT></TT><FONT COLOR="#000000">       is stored in the auxiliary variable </FONT><TT><FONT COLOR="#000000">temp</FONT></TT><FONT COLOR="#000000">;       then, item </FONT><TT><FONT COLOR="#000000">v[i-1] </FONT></TT><FONT COLOR="#000000">is       assigned with the value of item </FONT><TT><FONT COLOR="#000000">v[i]</FONT></TT><FONT COLOR="#000000">;       finally, item </FONT><TT><FONT COLOR="#000000">v[i] </FONT></TT><FONT COLOR="#000000">is       assigned with the value of the auxiliary variable </FONT><TT><FONT COLOR="#000000">temp</FONT></TT><FONT COLOR="#000000">.</FONT></font>     </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       second and the third assignment statements are interesting from a visualization       point of view, since they change the content of array </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">       that is referred to by predicate </FONT><TT><FONT COLOR="#007ECC">Rectangle</FONT></TT><FONT COLOR="#000000">.</FONT></font>     </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">Their       execution produces the following visual effect: first, the green rectangle       assumes the same height as the red rectangle, then the height of the red       rectangle increases and becomes equal to the previous height of the green       rectangle.</font></P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">However,       this effect is not desired, as we would like to consider the swap operation       as an atomic step. We can use the animation control predicate </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000"><A HREF="AppendixA1.html#VisualUpdate">VisualUpdateOn</A></FONT></TT><FONT COLOR="#000000">       to do this. In particular, you can paste the Alpha declarations </FONT><TT><FONT COLOR="#000000">/**       </FONT><FONT COLOR="#007F00">Not</FONT><FONT COLOR="#000000"> </FONT><FONT COLOR="#007ECC">VisualUpdateOn</FONT><FONT COLOR="#000000">;       **/</FONT></TT><FONT COLOR="#000000"> and </FONT><TT><FONT COLOR="#000000">/**       </FONT><FONT COLOR="#007ECC">VisualUpdateOn</FONT><FONT COLOR="#000000">;       **/</FONT></TT><FONT COLOR="#000000"> in the C source code as follows:</FONT></font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=5   WIDTH="90%">    <TR>       <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">#include           </FONT><FONT COLOR="#000000">&lt;stdio.h&gt;</FONT></TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">n;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[100];</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           HSpace 8</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Width 12</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Middle 150</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Dy 4</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">View</FONT>(<FONT COLOR="#007F00">Out</FONT>           0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT>(<FONT COLOR="#007F00">Out</FONT>           N,<FONT COLOR="#007F00">Out</FONT> X,<FONT COLOR="#007F00">Out</FONT>           Y,<FONT COLOR="#007F00">Out</FONT> L,<FONT COLOR="#007F00">Out</FONT>           H,0)</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             N: <FONT COLOR="#007ECC">InRange</FONT>(N,0,n-1)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign             </FONT>L=Width</TT> </font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>H=v[N]*Dy</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>X=HSpace+(HSpace+Width)*N</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Y=Middle-H/2;</TT></font></P>          </BLOCKQUOTE>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Set</FONT>           1: <FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>           <FONT COLOR="#BF3FBF">Grey</FONT>,0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">BubbleSort(</FONT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[],</FONT><FONT COLOR="#0000FF">int </FONT><FONT COLOR="#000000">n){</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i=-1,another; </FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>/**             </TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Negate</FONT>             1;</TT> </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>             C,0)</TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign</FONT>             C= (N==i) ? <FONT COLOR="#BF3FBF">Red</FONT> :</TT> </font>             <BLOCKQUOTE>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>(N==i-1)                 ? <FONT COLOR="#BF3FBF">Green</FONT> : <FONT COLOR="#BF3FBF">Grey</FONT>;</TT>                 </font>               </UL>            </BLOCKQUOTE>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT>             </font>        </UL>      </TD>      <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">do           </FONT><FONT COLOR="#000000">{ </FONT></TT> </font>           <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=0;             </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for               </FONT><FONT COLOR="#000000">(i=1;i&lt;n;i++) </FONT></TT></font></P>            <UL>              <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">if               ((v[i-1]&gt;v[i])) { </FONT></TT> </font>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long                 </FONT><FONT COLOR="#000000">temp=v[i-1];</FONT></TT> </font>                 <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**                   </FONT><FONT COLOR="#007F00">Not</FONT><FONT COLOR="#000000">                   </FONT><FONT COLOR="#007ECC">VisualUpdateOn</FONT><FONT COLOR="#000000">;                   **/</FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i-1]=v[i];                   </FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i]=temp;</FONT></TT>                   </font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**                   </FONT><FONT COLOR="#007ECC">VisualUpdateOn</FONT><FONT COLOR="#000000">;                   **/</FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=1;</FONT></TT>                   </font></P>              </UL>              <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}                 </FONT></TT></font></P>            </UL>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}             </FONT><FONT COLOR="#0000FF">while </FONT><FONT COLOR="#000000">(another);             </FONT></TT> </font></P>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">main(){ </FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i;</FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("How             many numbers ? "); </FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%d",&amp;n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) { </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("Enter             number #%d: ",i); </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%ld",&amp;v[i]);               </FONT></TT></font></P>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort<FONT COLOR="#000000">(v,n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("v[%d]=%ld\n",i,v[i]);             </FONT></TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">In     this way, you prevent the screen from being updated during the swap operation     and you can elide all the redundant visualization frames.</font>   </UL>  <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Step 6. Refining the visualization: designing a more robust geometric layout"></A><B><FONT COLOR="#007F00">Step     6. Refining the visualization: designing a more robust geometric layout</FONT></B></font></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The     geometric layout of rectangles that has been designed so far presents some     problems when values in </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">     are too large. For instance, try to insert a number greater than </FONT><TT><FONT COLOR="#000000">200</FONT></TT><FONT COLOR="#000000">;     you will see that the corresponding rectangle does not fit into the window.     Therefore, a more robust geometric layout must be designed.</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">First       of all, remember that rectangles are currently centered along a horizontal       axis whose vertical position is fixed and equal to the constant </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">Middle</FONT></TT><FONT COLOR="#000000">.       The solution to the layout problem shown so far consists in not keeping       this position fixed, but in making it change according to the maximum value       in array </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">.       In this way, the visualization of all rectangles will always fill into both       the left and the top side of the window. </FONT></font> </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">With       this aim, it is useful to define an auxiliary (non-standard) predicate that       can be used to make the implementation of predicate </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT></TT><FONT COLOR="#000000">       more readable. Note that auxiliary predicates play for Alpha programs the       same role that macros and subroutines have for C programs.</FONT></font></P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">We       call the auxiliary predicate </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">Max</FONT></TT><FONT COLOR="#000000">       and we define it as follows:</FONT></font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLPADDING=10 WIDTH="70%">    <TR>       <TD>         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Max(<FONT COLOR="#007F00">Out</FONT>             M)<FONT COLOR="#007F00"> Assign</FONT> M <FONT COLOR="#007F00">In</FONT>             {</TT></font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int</FONT>               h;</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>M=v[0];</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for</FONT>               (h=1;h&lt;n;h++) <FONT COLOR="#0000FF">if</FONT> (M&lt;v[h]) M=v[h];</TT>               </font></P>          </BLOCKQUOTE>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>};</TT></font></P>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT>           </font>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><BR>    </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">Max(</FONT><FONT COLOR="#007F00">Out</FONT><FONT COLOR="#000000">     M)</FONT></TT><FONT COLOR="#000000"> is an auxiliary predicate for computing     the maximum value in the array </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">.     This value is returned in the output parameter </FONT><TT><FONT COLOR="#000000">M</FONT></TT><FONT COLOR="#000000">.     Observe that </FONT><TT><FONT COLOR="#000000">Max</FONT></TT><FONT COLOR="#000000">     has been implemented by inserting a C block into an Alpha predicate body (see     Chapter 9 for details about the Alpha language).</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       previous declaration can be inserted in the global scope, just after the       declarations of C variables </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">n</FONT></TT><FONT COLOR="#000000">       and </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">.       Indeed, only these two variables are referred to by predicate </FONT><TT><FONT COLOR="#000000">Max</FONT></TT><FONT COLOR="#000000">.</FONT></font>     </P>    <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">At       this point, we can modify the implementation of predicate </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT></TT><FONT COLOR="#000000">       as follows:</FONT></font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLPADDING=10 WIDTH="70%">    <TR>       <TD>         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT>(<FONT COLOR="#007F00">Out</FONT>           N,<FONT COLOR="#007F00">Out</FONT> X,<FONT COLOR="#007F00">Out</FONT>           Y,<FONT COLOR="#007F00">Out</FONT> L,<FONT COLOR="#007F00">Out</FONT>           H,0)</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             M: Max(M)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             N: <FONT COLOR="#007ECC">InRange</FONT>(N,0,n-1)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign             </FONT>L=Width</TT> </font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>H=v[N]*Dy</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>X=HSpace+(HSpace+Width)*N</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Y=M*Dy/2-H/2;</TT></font>          </BLOCKQUOTE>        </BLOCKQUOTE>      </TD>    </TR>  </TABLE>  <p></P>  <UL>    <font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif"><BR>    Note that a local variable, i.e. </font><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">M</FONT></TT><FONT COLOR="#000000">,     is introduced for holding the maximum value in </FONT><TT><FONT COLOR="#000000">v</FONT></TT><FONT COLOR="#000000">     and the </FONT><TT><FONT COLOR="#007F00">For</FONT></TT><FONT COLOR="#000000">     statement is used in order to invoke predicate </FONT><TT><FONT COLOR="#000000">Max</FONT></TT><FONT COLOR="#000000">.     The value of </FONT><TT><FONT COLOR="#000000">M</FONT></TT><FONT COLOR="#000000">     is then used for the y-coordinate assignment: </FONT><TT><FONT COLOR="#000000">M*Dy/2</FONT></TT><FONT COLOR="#000000">     plays the role of </FONT><TT><FONT COLOR="#000000">Middle</FONT></TT><FONT COLOR="#000000">,     that is it indicates the vertical position of the horizontal axis along which     rectangles have to be aligned.</FONT></font>     <P><font size="2" color="#000000" face="Verdana, Arial, Helvetica, sans-serif">The       complete visualization code is shown below.</font></P>  </UL>  <P ALIGN=CENTER>  <TABLE BORDER=1 CELLSPACING=0 CELLPADDING=5   WIDTH="90%">    <TR>       <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">#include           </FONT><FONT COLOR="#000000">&lt;stdio.h&gt;</FONT></TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">n;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[100];</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           HSpace 8</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Width 12</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">#define</FONT>           Dy 4</TT> </font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>&nbsp;</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Max(<FONT COLOR="#007F00">Out</FONT>           M)<FONT COLOR="#007F00"> Assign</FONT> M <FONT COLOR="#007F00">In</FONT>           {</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int</FONT>             h;</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>M=v[0];</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for</FONT>             (h=1;h&lt;n;h++) <FONT COLOR="#0000FF">if</FONT> (M&lt;v[h]) M=v[h];</TT>             </font></P>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>};</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">View</FONT>(<FONT COLOR="#007F00">Out</FONT>           0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">Rectangle</FONT>(<FONT COLOR="#007F00">Out</FONT>           N,<FONT COLOR="#007F00">Out</FONT> X,<FONT COLOR="#007F00">Out</FONT>           Y,<FONT COLOR="#007F00">Out</FONT> L,<FONT COLOR="#007F00">Out</FONT>           H,0)</TT></font></P>        <BLOCKQUOTE>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             M: Max(M)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">For</FONT>             N: InRange(N,0,n-1)</TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign             </FONT>L=Width</TT> </font></P>          <BLOCKQUOTE>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>H=v[N]*Dy</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>X=HSpace+(HSpace+Width)*N</TT></font></P>            <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>Y=M*Dy/2-H/2;</TT></font></P>          </BLOCKQUOTE>        </BLOCKQUOTE>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Set</FONT>           1: <FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>           <FONT COLOR="#BF3FBF">Grey</FONT>,0);</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/</TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">BubbleSort(</FONT><FONT COLOR="#0000FF">long           </FONT><FONT COLOR="#000000">v[],</FONT><FONT COLOR="#0000FF">int </FONT><FONT COLOR="#000000">n){</FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i=-1,another; </FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>/**             </TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Negate</FONT>             1;</TT> </font>        </UL>      </TD>      <TD VALIGN=top nowrap bgcolor="#FFFFFF" width="50%">         <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007ECC">RectangleColor</FONT>(N,<FONT COLOR="#007F00">Out</FONT>           C,0)</TT> </font>           <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007F00">Assign</FONT>             C= (N==i) ? <FONT COLOR="#BF3FBF">Red</FONT> :</TT> </font>             <BLOCKQUOTE>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>(N==i-1)                 ? <FONT COLOR="#BF3FBF">Green</FONT> : <FONT COLOR="#BF3FBF">Grey</FONT>;</TT>                 </font>               </UL>            </BLOCKQUOTE>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>**/             </TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">do             </FONT><FONT COLOR="#000000">{ </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=0;             </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for               </FONT><FONT COLOR="#000000">(i=1;i&lt;n;i++) </FONT></TT></font></P>            <UL>              <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">if               ((v[i-1]&gt;v[i])) { </FONT></TT> </font>               <UL>                <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">long                 </FONT><FONT COLOR="#000000">temp=v[i-1];</FONT></TT> </font>                 <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**                   </FONT><FONT COLOR="#007F00">Not</FONT><FONT COLOR="#000000">                   </FONT><FONT COLOR="#007FCC">VisualUpdateOn</FONT><FONT COLOR="#000000">;                   **/</FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i-1]=v[i];                   </FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">v[i]=temp;</FONT></TT>                   </font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">/**                   </FONT><FONT COLOR="#007FCC">VisualUpdateOn</FONT><FONT COLOR="#000000">;                   **/</FONT></TT></font></P>                <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">another=1;</FONT></TT>                   </font></P>              </UL>              <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}                 </FONT></TT></font></P>            </UL>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}             </FONT><FONT COLOR="#0000FF">while </FONT><FONT COLOR="#000000">(another);             </FONT></TT> </font></P>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">&nbsp;</FONT></TT></font></P>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">void           </FONT><FONT COLOR="#000000">main(){ </FONT></TT></font></P>        <UL>          <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">int           </FONT><FONT COLOR="#000000">i;</FONT></TT> </font>           <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("How             many numbers ? "); </FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%d",&amp;n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) { </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("Enter             number #%d: ",i); </FONT></TT> </font>             <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">scanf</FONT><FONT COLOR="#000000">("%ld",&amp;v[i]);               </FONT></TT></font></P>          </UL>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT></font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT>BubbleSort<FONT COLOR="#000000">(v,n);</FONT></TT>             </font></P>          <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#0000FF">for             </FONT><FONT COLOR="#000000">(i=0;i&lt;n;i++) </FONT></TT></font></P>          <UL>            <font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#007FCC">printf</FONT><FONT COLOR="#000000">("v[%d]=%ld\n",i,v[i]);             </FONT></TT> </font>           </UL>        </UL>        <P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><TT><FONT COLOR="#000000">}</FONT></TT>           </font>      </TD>    </TR>  </TABLE>  <p></P></UL><P>&nbsp;</P><P><font face="Verdana, Arial, Helvetica, sans-serif" size="2"><A NAME="Another visualization example: the breadth-first visit of a graph"></A><FONT COLOR="#990000">2.3   - Another visualization example: the breadth-first visit of a graph</FONT></font></P><BLOCKQUOTE>   <UL>    <font size="2" face="Verdana, Arial, Helvetica, sans-serif">Sorry, this example     is still under construction.</font>   </UL></BLOCKQUOTE><P ALIGN=CENTER><font face="Verdana, Arial, Helvetica, sans-serif" size="1">[<A HREF="../Index.html">Index   page</A>]</font></P></BODY></HTML>